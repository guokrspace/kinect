define(function(w,f){var g=this,t=function(){SFNode.removeRoute(d,"time",g,a);d.stopTime=Date.now();d.enabled=!1;j=0;h={}},m=function(e,u){var b=r();e[b]=u;h[b]=[e,b];1!==j&&(0===j?(SFNode.createRoute(d,"time",g,a),d.enabled=!0,d.loop=0,d.startTime=Date.now()):2===j&&clearTimeout(s),j=1,l=Date.now());return b},k=function(e){return h[e]?(delete h[e][0][h[e][1]],delete h[e],!0):!1},a="time_for_timer",d,l=Date.now(),n={},p={},q={},s=0,j=0,h={};if(d=SFNode.get("drawsensor_for_timer"))if(isNaN(g.getField("time_for_timer")))print("加载Timer失败：所在Script脚本中，没有正确配置 eventIn SFTime "+
a+" 的eventIn");else{"function"===typeof g[a]&&print("\nWARN by Timer: 在初始化Timer时，发现"+a+" eventIn 已被以下函数占用:将覆盖\n"+g[a]);g[a]=function(e){if(1===j){var d=Date.now(),b=!1,c;for(c in q){var b=q[c],a=(d-b.startTime)/b.duration,a=1<a?1:0>a?0:a;try{b.fun.call(null,a,c),1==a&&(b.callBack&&b.callBack.call(b,c)?b.startTime=d:k(c))}catch(f){print("WARN by Timer:绑定的函数出错，已被移除："+f.stack+"===="+a),k(c)}b=!0}for(c in n){try{n[c].call(null,d-l,c)}catch(g){print("WARN by Timer:绑定的函数出错，已被移除："+g.stack),k(c)}b=!0}for(c in p){try{p[c].call(null,
d,c)}catch(h){print("WARN by Timer:绑定的函数出错，已被移除："+h.stack),k(c)}b=!0}l=e;b||(s=setTimeout(t,10),j=2)}};var r,v=0;r=function(){return v++};f.bindFraction=function(e,a,b){return m(q,{startTime:Date.now(),duration:e,fun:a,callBack:b})};f.bindTime=function(a){return m(p,a)};f.bindDTime=function(a){return m(n,a)};f.clear=function(a){return k(a)};f.pause=function(){};f.unpause=function(){}}else print("加载Timer失败：没有找到DEF drawsensor_for_timer DrawSensor{}节点")});
