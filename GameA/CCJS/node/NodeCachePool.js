define(function(h,j){function m(a,b,d){var g=a in c?c[a].nodes.length:0,e=[],e=a+"_"+g+"_"+k.hex_md5(d);if(a in c)b=c[a].resourceid;else{var f=l.cache(b);b=f.id;c[a]=[];c[a].resourceid=f.id;c[a].nodes=[]}f="";d?f=d.replace("s%","USE "+b):(f=f+"Transform{ children ["+("USE "+b),f+="]}");e=[new SFNode(f),1,e];c[a].nodes[g]=e;return{id:e[2],node:e[0]}}var c={},k=h("utils/Md5"),l=h("node/NodeCache");h("core/Logger").getLog();j.create=function(a,b,d){l.basePath=d;d=k.hex_md5(a);b=b||"";if(d in c&&0<c[d].nodes.length){a:{for(var g=
c[d].nodes,e=0,f=g.length;e<f;e++){var h=d+"_"+e+"_"+k.hex_md5(b);if(g[e][2]==h&&0==g[e][1]){g[e][1]=1;a={id:d+"_"+e,node:g[e][0]};break a}}a=m(d,a,b)}return a}return m(d,a,b)};j.remove=function(a){if(a){var b=a.split("_");c[b[0]].nodes[b[1]][1]=0}else for(b in c){a=0;for(var d=c[b].nodes.length;a<d;a++)c[b].nodes[a][1]=0}};j.destory=function(){c={};l.destory()}});
