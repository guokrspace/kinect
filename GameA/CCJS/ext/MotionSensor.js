define(function(t,c){function l(b){var a;if(!d){d=new SFNode("DEF MotionMovieSwitch Switch{whichChoice -1 }");try{a=SFNode.get("lyinux->userscenegraphroot").getChild(0)}catch(c){e.error(c),a=void 0}a.addChild(d)}b=new SFNode("DEF "+b+' MovieTexture{url "'+m.videoUrl+'" loop FALSE }');d.addChild(b.getChild(0))}var n=this,e=t("core/Logger").getLog(),p=!1,m={videoUrl:"/src/ext/1.wmv"},a=0,k={},f=0,j={},g=0,q=!1,r=!1,s=!1,d=null;c.init=function(){p||(p=!0,e.info("################### MotionSensor init !"),
regiest(0,100),n.setState=function(){})};c.config=function(b){if(b&&"[object Object]"===Object.prototype.toString.call(b))for(var a in b)m[a]&&(m[a]=b[a]);else e.error("配置参数不是一个对象")};c.listenDepthData=function(b){if(b){f++;k[""+f]=b;if(1<f)return f;0==g&&(a=0!=a?a+1:1,regiest(100+a,100));var c=2/240,h=new MFVec3f;n.skeDepthChange=function(){if(-1!=arguments[0]){var a=0,b,f;h.length=0;for(var g=arguments,e=1,j=g.length;e<j;e+=3)b=g[e+1],f=g[e],f=(f-160)*c,b=(240-b)*c,h[a].setValue(f,b,0),a++;for(var d in k)k[d](h)}};
return f}e.error("获取深度骨骼数据时，没有提供 参数[function]")};c.depthDataDestory=function(a){k[a]&&delete k[a]};c.listenFrameData=function(b){if(b){g++;j[""+g]=b;if(1<g)return g;0==f&&(a=0!=a?a+1:1,regiest(100+a,100));var c=new MFVec3f,h,d;n.frameChange=function(){d=arguments;if(-1!==d[0]){h=0;for(var a=1,b=d.length;a<b;a+=4)c[h].setValue(d[a]/1E3,d[a+1]/1E3,d[a+2]/1E3),h++;for(var e in j)j[e](c)}};return g}e.error("获取骨骼数据时，没有提供 参数[function]")};c.frameDataDestory=function(a){j[a]&&delete j[a]};c.openDepthMovie=
function(b){q||(q=!0,l("depthMovie"),a=0!=a?a+2:2,regiest(100+a,100),b("depthMovie"))};c.openRGBMovie=function(b){r||(r=!0,l("colorMovie"),a=0!=a?a+4:4,regiest(100+a,100),b("colorMovie"))};c.openPersonRGBMovie=function(b){s||(s=!0,l("greenScreenMovie"),a=0!=a?a+8:8,regiest(100+a,100),b("greenScreenMovie"))}});
